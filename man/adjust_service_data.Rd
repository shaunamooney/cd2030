% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/adjust_service_data.R
\name{adjust_service_data}
\alias{adjust_service_data}
\title{Adjust Service Data for Coverage Analysis}
\usage{
adjust_service_data(
  .data,
  adjustment = c("default", "custom", "none"),
  k_factors = NULL
)
}
\arguments{
\item{.data}{A \code{cd_data} dataframe, typically containing health facility data
from DHIS-2 with monthly service counts by district.}

\item{adjustment}{A character string specifying the type of adjustment to apply:
\itemize{
\item \strong{"default"}: Applies a default k-factor of 0.25 across all indicator groups.
\item \strong{"custom"}: Uses user-defined \code{k_factors} for different indicator groups, with
values between 0 and 1.
\item \strong{"none"}: Returns the data without any adjustments.
}}

\item{k_factors}{A named numeric vector of custom k-factor values between 0 and 1
for each indicator group (e.g., \code{c(anc = 0.3, idelv = 0.2, ...)}). Used only if
\code{adjustment = "custom"}.}
}
\value{
A \code{cd_adjusted_data} object containing adjusted service data, where outliers are flagged
and managed, and missing values are imputed.
}
\description{
The \code{adjust_service_data} function processes DHIS-2 health service data, correcting
for incomplete reporting, applying k-factor adjustments for accurate scaling, and managing
outliers for consistency in data analysis. This standardization supports reliable
comparisons in immunization coverage and health service utilization studies.
}
\details{
This function prepares service data through a series of steps to ensure data quality and consistency:
\enumerate{
\item \strong{Validation}: Checks the structure of \code{.data} and ensures that the \code{adjustment}
argument is valid. For \code{custom} adjustments, \code{k_factors} must be specified and contain valid values.
\item \strong{k-Factor Defaults}: Default k-factor values are set to 0.25 for each indicator group,
unless overridden by user-provided values in \code{k_factors}.
\item \strong{Reporting Completeness}: Flags any district-year reporting rates below 75\% and imputes
missing data using district-level medians to account for reporting inconsistencies.
\item \strong{k-Factor Scaling}: Adjusts service counts based on the k-factor and reporting rate using
the following scaling formula:
\deqn{AdjustedValue = Value \times \left(1 + \left(\frac{1}{ReportingRate/100} - 1\right) \times k\right)}
where \code{ReportingRate} is the reporting rate in percent, and \code{k} is the k-factor for the indicator group.
\item \strong{Outlier Detection}: Identifies and flags extreme outliers using Hampel's X84 method, marking
values that exceed 5 Median Absolute Deviations (MAD) from the median.
\item \strong{Data Imputation}: Replaces remaining missing values with district-level medians to ensure
data completeness.
}
}
\examples{
\dontrun{
# Default adjustment
adjusted_data <- adjust_service_data(data, adjustment = "default")

# Custom adjustment with specific k-factors
custom_k <- c(anc = 0.3, idelv = 0.2, pnc = 0.35, vacc = 0.4,
              opd = 0.3, ipd = 0.25)
adjusted_data_custom <- adjust_service_data(data, adjustment = "custom",
                                            k_factors = custom_k)

# No adjustment
unadjusted_data <- adjust_service_data(data, adjustment = "none")
}

}
\seealso{
\code{\link[=new_countdown]{new_countdown()}} for creating \code{cd_data} objects and \code{\link[=generate_adjustment_values]{generate_adjustment_values()}}
for generating adjustment summaries.
}
